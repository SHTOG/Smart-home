## 自定义指令(中控与终端)

本套指令格式用于无线传输的数据

### 数据帧格式(hex格式)

| 帧头        | 自身长地址              | 命令码(设备类型码) | 有效数据长度 | 有效数据 | 回车  |
| ----------- | ----------------------- | ------------------ | ------------ | -------- | ----- |
| C1 C2 C3 C4 | XX XX XX XX XX XX XX XX | AA                 | YY           | ZZ ZZ……  | 0D 0A |
| 4字节       | 8字节                   | 1字节              | 1字节        | ≥0       | 2字节 |

ps：命令码同时也是设备类型码（除了0x00和0xFF）

### 设备类型码表

| 具体设备中文名 | 对应码十六进制 |
| -------------: | -------------- |
|           电灯 | 0x01           |
|           空调 | 0x02           |
|           窗帘 | 0x03           |
|           门锁 | 0x04           |
|           音响 | 0x05           |
|                |                |
|                |                |
|                |                |
|                |                |



### 设备应答命令0xFF

有效数据内容

| 应答信息                           |
| ---------------------------------- |
| 2字节['O' 'K'(0x4F 0x4B)]、[03 xx] |

例：（发出应答设备长地址70 E4 61 25 00 4B 12 00）

设备应答ok：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 FF 02 4F 4B 0D 0A

设备应答（密文）:

### 设备信息命令0x00

**有效数据内容**

| 命令源设备类型码 | 短地址 |
| :--------------- | :----- |
| 1字节            | 2字节  |

例：（长地址为17 48 9E 19 00 4B 12 00、短地址为D3 4A）

发送电灯控制器终端的信息：C1 C2 C3 C4 17 48 9E 19 00 4B 12 00 00 03 01 D3 4A 0D 0A

### 电灯控制命令0x01

**有效数据内容**

| 目标电灯号              | 控制命令码 |
| ----------------------- | ---------- |
| 1字节（00表示对所有灯） | 1~2字节    |



例：（向一号电灯发出命令设备长地址为70 E4 61 25 00 4B 12 00）

关灯(灯泡断电)：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 00 0D 0A

开灯(灯泡上电)：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 01 0D 0A

亮度+：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 02 0D 0A

亮度-：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 03 0D 0A

亮度调至指定档位：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 03 01 04 XX 0D 0A（XX为档位）(档位为0~10) 
这里我对APP有个建议就是设立一个"亮度条"，分0~11个结点，拉到哪个节点就发送对应档位指令，一被拉动就发送，可以体现“高灵敏”

进入普通模式：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 05 0D 0A

所有灯进入普通模式：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 00 05 0D 0A

进入呼吸灯模式：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 01 06 0D 0A

所有灯进入同步呼吸模式：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 01 02 00 06 0D 0A

### 窗帘控制命令0x03

**有效数据内容**

|                 控制命令码                  |
| :-----------------------------------------: |
| 1字节（具体程度(deep)(0x00~0x80)） |

例：中控长地址为70 E4 61 25 00 4B 12 00,打开程度为40/128（十进制）

窗帘打开到指定程度：C1 C2 C3 C4 70 E4 61 25 00 4B 12 00 03 01 28 0D 0A


## 自定义指令(中控与ESP32)

### 数据帧格式(hex格式)

| 帧头        | 目标短地址 | 命令码(设备类型码) | 有效数据长度 | 有效数据 | 回车(帧尾) |
| ----------- | ---------- | ------------------ | ------------ | -------- | ---------- |
| A1 A2 A3 A4 | XX XX      | AA                 | YY           | ZZ ZZ……  | 0D 0A      |
| 4字节       | 2字节      | 1字节              | 1字节        | ≥0       | 2字节      |

ps：命令码同时也是设备类型码（除了0x00和0xFF）

### 设备类型码表

| 具体设备中文名 | 对应码十六进制 |
| -------------: | -------------- |
|           电灯 | 0x01           |
|           空调 | 0x02           |
|           窗帘 | 0x03           |
|           门锁 | 0x04           |
|           音响 | 0x05           |
|                |                |
|                |                |
|                |                |
|                |                |



### 设备应答命令0xFF

有效数据内容

| 'O' 'K'(0x4F 0x4B) |
| ------------------ |
| 2字节              |

例：（应答目标设备短地址00 00）

A1 A2 A3 A4 00 00 FF 02 4F 4B 0D 0A

### 设备信息命令0x00

**有效数据内容**

| 命令源设备类型码 | 入网标志（0-未入网，1-已入网） | 设备长地址 | 设备短地址 |
| :--------------- | :----------------------------- | ---------- | ---------- |
| 1字节            | 1字节                          | 8字节      | 2字节      |

例：（设备类型为01、入网标志为1、长地址为17 48 9E 19 00 4B 12 00、短地址为D3 4A）

发送信息开始信号：A1 A2 A3 A4 00 00 00 00 0D 0A

向APP发送电灯控制器终端的信息：A1 A2 A3 A4 00 00 00 0C 01 01 17 48 9E 19 00 4B 12 00 D3 4A 0D 0A

### 电灯控制命令0x01

**有效数据内容**

| 目标电灯号              | 控制命令码 |
| ----------------------- | ---------- |
| 1字节（00表示对所有灯） | 1~2字节    |

例：（目标灯泡终端短地址为0x1111）

关灯(灯泡断电)：A1 A2 A3 A4 11 11 01 02 01 00 0D 0A

开灯(灯泡上电)：A1 A2 A3 A4 11 11 01 02 01 01 0D 0A

亮度+：A1 A2 A3 A4 11 11 01 02 01 02 0D 0A

亮度-：A1 A2 A3 A4 11 11 01 02 01 03 0D 0A

亮度调至指定档位：A1 A2 A3 A4 11 11 01 03 01 04 XX 0D 0A（XX为档位）(档位为0~10) 
这里我对APP有个建议就是设立一个"亮度条"，分0~10个结点，拉到哪个节点就发送对应档位指令，一被拉动就发送，可以体现“高灵敏”

进入普通模式：A1 A2 A3 A4 11 11 01 02 01 05 0D 0A

所有灯进入普通模式：A1 A2 A3 A4 11 11 01 02 00 05 0D 0A

进入呼吸灯模式：A1 A2 A3 A4 11 11 01 02 01 06 0D 0A

所有灯进入同步呼吸模式：A1 A2 A3 A4 11 11 01 02 00 06 0D 0A

### 窗帘控制命令0x03

**有效数据内容**

|              控制命令码               |
| :-----------------------------------: |
| 1字节（对应的CurtainDeep）(0x00~0x80) |

例：目标窗帘短地址为 A5 49

关：A1 A2 A3 A4 A5 49 03 01 00 0D 0A

开：A1 A2 A3 A4 A5 49 03 01 80 0D 0A

指定Deep：A1 A2 A3 A4 A5 49 03 01 xx 0D 0A
